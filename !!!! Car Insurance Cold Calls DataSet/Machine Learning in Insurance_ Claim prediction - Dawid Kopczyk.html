<!DOCTYPE html>

<html lang="en-US" prefix="og: http://ogp.me/ns#">

	<head>
		
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" >
						 
		<title>Machine Learning in Insurance: Claim prediction - Dawid Kopczyk</title>

<!-- This site is optimized with the Yoast SEO plugin v8.3 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="In this post, we will suggest replacing the traditional methods of claims prediction with machine learning algorithms to build more accurate models."/>
<link rel="canonical" href="http://dkopczyk.quantee.co.uk/claim-prediction/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Machine Learning in Insurance: Claim prediction - Dawid Kopczyk" />
<meta property="og:description" content="In this post, we will suggest replacing the traditional methods of claims prediction with machine learning algorithms to build more accurate models." />
<meta property="og:url" content="http://dkopczyk.quantee.co.uk/claim-prediction/" />
<meta property="og:site_name" content="Dawid Kopczyk" />
<meta property="article:section" content="Machine Learning" />
<meta property="article:published_time" content="2019-04-08T19:28:02+00:00" />
<meta property="article:modified_time" content="2019-06-05T20:35:58+00:00" />
<meta property="og:updated_time" content="2019-06-05T20:35:58+00:00" />
<meta property="og:image" content="http://dkopczyk.quantee.co.uk/wp-content/uploads/2019/04/intro.jpeg" />
<meta property="og:image:width" content="800" />
<meta property="og:image:height" content="587" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="In this post, we will suggest replacing the traditional methods of claims prediction with machine learning algorithms to build more accurate models." />
<meta name="twitter:title" content="Machine Learning in Insurance: Claim prediction - Dawid Kopczyk" />
<meta name="twitter:image" content="http://dkopczyk.quantee.co.uk/wp-content/uploads/2019/04/intro.jpeg" />
<script type='application/ld+json'>{"@context":"https:\/\/schema.org","@type":"Person","url":"http:\/\/dkopczyk.quantee.co.uk\/","sameAs":["https:\/\/www.linkedin.com\/in\/dawid-kopczyk-quantee\/"],"@id":"#person","name":"Dawid Kopczyk"}</script>
<!-- / Yoast SEO plugin. -->

<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//secure.gravatar.com' />
<link rel='dns-prefetch' href='//cdn.jsdelivr.net' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="Dawid Kopczyk &raquo; Feed" href="http://dkopczyk.quantee.co.uk/feed/" />
<link rel="alternate" type="application/rss+xml" title="Dawid Kopczyk &raquo; Comments Feed" href="http://dkopczyk.quantee.co.uk/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="Dawid Kopczyk &raquo; Machine Learning in Insurance: Claim prediction Comments Feed" href="http://dkopczyk.quantee.co.uk/claim-prediction/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/dkopczyk.quantee.co.uk\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.12"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='style_main-css'  href='http://dkopczyk.quantee.co.uk/wp-content/plugins/wp-gif-player/style.css?ver=1519304492' type='text/css' media='all' />
<link rel='stylesheet' id='wp-quicklatex-format-css'  href='http://dkopczyk.quantee.co.uk/wp-content/plugins/wp-quicklatex/css/quicklatex-format.css?ver=4.9.12' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-css'  href='http://dkopczyk.quantee.co.uk/wp-content/plugins/crayon-syntax-highlighter/css/min/crayon.min.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='http://dkopczyk.quantee.co.uk/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='http://dkopczyk.quantee.co.uk/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='dashicons-css'  href='http://dkopczyk.quantee.co.uk/wp-includes/css/dashicons.min.css?ver=4.9.12' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack-widget-social-icons-styles-css'  href='http://dkopczyk.quantee.co.uk/wp-content/plugins/jetpack/modules/widgets/social-icons/social-icons.css?ver=20170506' type='text/css' media='all' />
<link rel='stylesheet' id='tablepress-default-css'  href='http://dkopczyk.quantee.co.uk/wp-content/tablepress-combined.min.css?ver=14' type='text/css' media='all' />
<link rel='stylesheet' id='bfa-font-awesome-css'  href='//cdn.jsdelivr.net/fontawesome/4.7.0/css/font-awesome.min.css?ver=4.7.0' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='http://dkopczyk.quantee.co.uk/wp-content/plugins/jetpack/css/jetpack.css?ver=6.5' type='text/css' media='all' />
<link rel='stylesheet' id='baskerville_googleFonts-css'  href='//fonts.googleapis.com/css?family=Roboto+Slab%3A400%2C700%7CRoboto%3A400%2C400italic%2C700%2C700italic%2C300%7CPacifico%3A400&#038;ver=4.9.12' type='text/css' media='all' />
<link rel='stylesheet' id='baskerville_style-css'  href='http://dkopczyk.quantee.co.uk/wp-content/themes/baskerville/style.css?ver=4.9.12' type='text/css' media='all' />
<script type='text/javascript' src='http://dkopczyk.quantee.co.uk/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='http://dkopczyk.quantee.co.uk/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/dkopczyk.quantee.co.uk\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type='text/javascript' src='http://dkopczyk.quantee.co.uk/wp-content/plugins/crayon-syntax-highlighter/js/min/crayon.min.js?ver=_2.7.2_beta'></script>
<script type='text/javascript' src='http://dkopczyk.quantee.co.uk/wp-content/themes/baskerville/js/imagesloaded.pkgd.js?ver=1'></script>
<script type='text/javascript' src='http://dkopczyk.quantee.co.uk/wp-content/themes/baskerville/js/flexslider.min.js?ver=1'></script>
<script type='text/javascript' src='http://dkopczyk.quantee.co.uk/wp-content/plugins/wp-quicklatex/js/wp-quicklatex-frontend.js?ver=1.0'></script>
<link rel='https://api.w.org/' href='http://dkopczyk.quantee.co.uk/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://dkopczyk.quantee.co.uk/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://dkopczyk.quantee.co.uk/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.9.12" />
<link rel='shortlink' href='https://wp.me/p9E3p5-hD' />
<link rel="alternate" type="application/json+oembed" href="http://dkopczyk.quantee.co.uk/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fdkopczyk.quantee.co.uk%2Fclaim-prediction%2F" />
<link rel="alternate" type="text/xml+oembed" href="http://dkopczyk.quantee.co.uk/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fdkopczyk.quantee.co.uk%2Fclaim-prediction%2F&#038;format=xml" />

<link rel='dns-prefetch' href='//v0.wordpress.com'/>
<style type='text/css'>img#wpstats{display:none}</style><style type="text/css">
/* <![CDATA[ */
img.latex { vertical-align: middle; border: none; }
/* ]]> */
</style>
<link rel="icon" href="http://dkopczyk.quantee.co.uk/wp-content/uploads/2018/03/cropped-logo_blue-32x32.png" sizes="32x32" />
<link rel="icon" href="http://dkopczyk.quantee.co.uk/wp-content/uploads/2018/03/cropped-logo_blue-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon-precomposed" href="http://dkopczyk.quantee.co.uk/wp-content/uploads/2018/03/cropped-logo_blue-180x180.png" />
<meta name="msapplication-TileImage" content="http://dkopczyk.quantee.co.uk/wp-content/uploads/2018/03/cropped-logo_blue-270x270.png" />
	
	</head>
	
	<body class="post-template-default single single-post postid-1093 single-format-standard has-featured-image is_mobile single single-post">

			
		<div class="header section small-padding bg-dark bg-image" style="background-image: url( http://dkopczyk.quantee.co.uk/wp-content/uploads/2018/02/cropped-2.jpg );">
		
			<div class="cover"></div>
			
			<div class="header-search-block bg-graphite hidden">
			
				<form method="get" class="searchform" action="http://dkopczyk.quantee.co.uk/">
	<input type="search" value="" placeholder="Search form" name="s" class="s" /> 
	<input type="submit" class="searchsubmit" value="Search">
</form>			
			</div><!-- .header-search-block -->
					
			<div class="header-inner section-inner">
			
												
					<h1 class="blog-title">
						<a href="http://dkopczyk.quantee.co.uk" title="Dawid Kopczyk &mdash; Enthusiastically about algorithms" rel="home">Dawid Kopczyk</a>
					</h1>
					
										
						<h3 class="blog-description">Enthusiastically about algorithms</h3>
						
															
											
			</div><!-- .header-inner -->
						
		</div><!-- .header -->
		
		<div class="navigation section no-padding bg-dark">
		
			<div class="navigation-inner section-inner">
			
				<div class="nav-toggle fleft hidden">
					
					<div class="bar"></div>
					<div class="bar"></div>
					<div class="bar"></div>
					
					<div class="clear"></div>
					
				</div>
						
				<ul class="main-menu">
				
					<li id="menu-item-16" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-16"><a href="http://dkopczyk.quantee.co.uk/about-me/">About Me</a></li>
<li id="menu-item-17" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-17"><a href="http://dkopczyk.quantee.co.uk/category/machine_learning/">Machine Learning</a></li>
<li id="menu-item-18" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-18"><a href="http://dkopczyk.quantee.co.uk/category/quantum_computing/">Quantum Computing</a></li>
<li id="menu-item-426" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-426"><a href="http://dkopczyk.quantee.co.uk/contact_form/">Contact</a></li>
											
				 </ul><!-- .main-menu -->
				 
				 <a class="search-toggle fright" href="#"></a>
				 
				 <div class="clear"></div>
				 
			</div><!-- .navigation-inner -->
			
		</div><!-- .navigation -->
		
		<div class="mobile-navigation section bg-graphite no-padding hidden">
					
			<ul class="mobile-menu">
			
				<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-16"><a href="http://dkopczyk.quantee.co.uk/about-me/">About Me</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-17"><a href="http://dkopczyk.quantee.co.uk/category/machine_learning/">Machine Learning</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-18"><a href="http://dkopczyk.quantee.co.uk/category/quantum_computing/">Quantum Computing</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-426"><a href="http://dkopczyk.quantee.co.uk/contact_form/">Contact</a></li>
										
			 </ul><!-- .main-menu -->
		
		</div><!-- .mobile-navigation -->
<div class="wrapper section medium-padding">
										
	<div class="section-inner">
	
		<div class="content center">
												        
									
				<div id="post-1093" class="post-1093 post type-post status-publish format-standard has-post-thumbnail hentry category-machine_learning">

									
					<div class="post-header">

												
						    <h1 class="post-title"><a href="http://dkopczyk.quantee.co.uk/claim-prediction/" rel="bookmark" title="Machine Learning in Insurance: Claim prediction">Machine Learning in Insurance: Claim prediction</a></h1>

											    
					</div><!-- .post-header -->
					
										

					
																			                                    	    
					<div class="post-content">
						
						<p><img class="aligncenter size-full wp-image-1098" src="http://dkopczyk.quantee.co.uk/wp-content/uploads/2019/04/intro.jpeg" alt="" width="800" height="587" srcset="http://dkopczyk.quantee.co.uk/wp-content/uploads/2019/04/intro.jpeg 800w, http://dkopczyk.quantee.co.uk/wp-content/uploads/2019/04/intro-300x220.jpeg 300w, http://dkopczyk.quantee.co.uk/wp-content/uploads/2019/04/intro-768x564.jpeg 768w, http://dkopczyk.quantee.co.uk/wp-content/uploads/2019/04/intro-600x440.jpeg 600w" sizes="(max-width: 800px) 100vw, 800px" /></p>
<p>The ability to <strong>predict a correct claim amount</strong> has a significant impact on insurer&#8217;s management decisions and financial statements. In this post, we will suggest replacing the traditional methods used by insurance companies with machine learning algorithms to build accurate predictive models. This will lead to a better understanding of insurance claim costs on both individual and aggregate policy levels.</p>
<p>In this post you will learn:</p>
<ul>
<li>How insurance companies predict claims costs currently and why it is important?</li>
<li>How machine learning algorithms can be used to help insurance companies in claim prediction problem?</li>
</ul>
<p>In a Python example, we will use the data coming from Kaggle <a href="https://www.kaggle.com/c/allstate-claims-severity" target="_blank" rel="noopener">Allstate Claims Severity competition</a>.</p>
<p>The post is a part of Machine Learning in Insurance series. If you are interested in the topic you can also read the following posts:</p>
<ul>
<li><a href="http://dkopczyk.quantee.co.uk/proxy/" target="_blank" rel="noopener">Machine Learning in Insurance: Proxy Models</a></li>
<li>Machine Learning in Insurance: Underwriting (in progress)</li>
</ul>
<h3>Traditional Claim Prediction</h3>
<p>Insurance companies sell promises &#8211; in a return for a premium, they guarantee that if something bad would happen, a policyholder will get a certain amount of benefit according to a policy sum assured. After such policy is sold, it can pass many years until a claim is made. For covering such future payments, insurers set up a reserve called also <a href="https://en.wikipedia.org/wiki/Loss_reserving">Claims Reserve</a>, calculated by financial department and actuaries (statisticians in insurance companies).</p>
<div id="attachment_1099" style="width: 471px" class="wp-caption aligncenter"><img class="size-full wp-image-1099" src="http://dkopczyk.quantee.co.uk/wp-content/uploads/2019/04/cycle.png" alt="" width="461" height="234" srcset="http://dkopczyk.quantee.co.uk/wp-content/uploads/2019/04/cycle.png 461w, http://dkopczyk.quantee.co.uk/wp-content/uploads/2019/04/cycle-300x152.png 300w" sizes="(max-width: 461px) 100vw, 461px" /><p class="wp-caption-text">The simplified life cycle of vehicle policy from the beginning, through an event (accident), claim filing, reporting and final claim payment. The claim reserve must be settled down at the very begging of the cycle to cover future losses for insurer.</p></div>
<p>It is extremely important to predict the final amount of claims and estimate Claims Reserve as accurately as possible so that insurers can:</p>
<ul>
<li>effectively<strong> utilize the capital</strong> if it is not meant to build reserves,</li>
<li>make <strong>better management decisions</strong> about investments, new products and sales strategy,</li>
<li>build <strong>trust</strong> <strong>and stability</strong> through accurate financial statements.</li>
</ul>
<p>Traditionally, insurers predict claim amount by taking similar groups of policies and analyzing their historical development of losses. Based on patterns from historical data, some estimates of claim amounts are produced. Moreover, one has to include expert adjustments to accommodate the fact that data is historical, but we predict on new policies. Then, the groups of policies are aggregated to get Claims Reserve amount that will be placed on financial statement.</p>
<div id="attachment_1100" style="width: 993px" class="wp-caption aligncenter"><img class="size-full wp-image-1100" src="http://dkopczyk.quantee.co.uk/wp-content/uploads/2019/04/traditional.png" alt="" width="983" height="322" srcset="http://dkopczyk.quantee.co.uk/wp-content/uploads/2019/04/traditional.png 983w, http://dkopczyk.quantee.co.uk/wp-content/uploads/2019/04/traditional-300x98.png 300w, http://dkopczyk.quantee.co.uk/wp-content/uploads/2019/04/traditional-768x252.png 768w, http://dkopczyk.quantee.co.uk/wp-content/uploads/2019/04/traditional-945x310.png 945w, http://dkopczyk.quantee.co.uk/wp-content/uploads/2019/04/traditional-600x197.png 600w" sizes="(max-width: 983px) 100vw, 983px" /><p class="wp-caption-text">Traditional method of estimating Claim Reserve</p></div>
<p>The method produces a good estimate of Claims Reserve, but the <strong>final claim payment is always somewhat different</strong> than the expected one. There are two sources of the difference.</p>
<ol>
<li>Firstly, actuaries take the group of similar policies and do not take into account<strong> individual characteristics of policyholders</strong>. Thus, it can turn out that some individuals are not following the patterns of a group and claims are much smaller or higher for them, impacting the aggregated result.</li>
<li>Secondly, in the time between a claim&#8217;s initial filing and full payment, the <strong>final amount of the claim can change drastically</strong>. Thus, insurers have to set up an additional <em>outstanding</em> reserve for losses that have been incurred, but have not officially been reported.</li>
</ol>
<p><strong><span style="text-decoration: underline;">Can we improve the predictability of future claims?</span></strong></p>
<h3>Machine Learning Benefit</h3>
<p>There are certain benefits of using machine learning approach in claim prediction problem:</p>
<ul>
<li>The algorithms can discover patterns from data that is not used in traditional approaches (all characteristics of a policyholder),</li>
<li>Due to the automated approach, they can predict payments on an individual policy level,</li>
<li>They catch non-linear effects in the data.</li>
</ul>
<p>All of these bullet points translate into <strong>improved predictability</strong> and <strong>greater stability</strong> of the claim modeling. Moreover, using artificial intelligence can greatly automate the process, so that specialists can dedicate their time on the results analysis, instead of taking care of sloppy excel calculations. As there is a speedup in the process, the sales representatives can immediately get the expected claim cost based on the past data leading to better sales decisions.</p>
<h3>Empirical study</h3>
<h4>Problem</h4>
<p>Kaggle published <a href="https://www.kaggle.com/c/allstate-claims-severity" target="_blank" rel="noopener">a competition </a>in which they ask data scientists to <strong>create an algorithm which accurately predicts claims severity for vehicle insurance</strong>. The competition is based on the data provided by Allstate, one the largest insurance company in the US investing recently a lot of effort in AI solutions for their processes, products and clients.</p>
<p>We will download the Kaggle data, fit two estimators and submit the prediction to check the results. The goal is to show, that having both claims data and policyholder data, we can build a reasonable machine learning algorithm, which simplifies the traditional methodologies and improve the predictability.</p>
<p>To begin let&#8217;s import Python libraries that we will use in the code example.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5dbb3e87e5f8f015182096" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
import pandas as pd # Data-Frames

from sklearn.linear_model import LinearRegression # Linear models
from sklearn.ensemble import RandomForestRegressor # Random Forest</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5dbb3e87e5f8f015182096-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5dbb3e87e5f8f015182096-2">2</div><div class="crayon-num" data-line="crayon-5dbb3e87e5f8f015182096-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5dbb3e87e5f8f015182096-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5dbb3e87e5f8f015182096-1"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">pandas </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-h"> </span><span class="crayon-c"># Data-Frames</span></div><div class="crayon-line crayon-striped-line" id="crayon-5dbb3e87e5f8f015182096-2">&nbsp;</div><div class="crayon-line" id="crayon-5dbb3e87e5f8f015182096-3"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">LinearRegression</span><span class="crayon-h"> </span><span class="crayon-c"># Linear models</span></div><div class="crayon-line crayon-striped-line" id="crayon-5dbb3e87e5f8f015182096-4"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">RandomForestRegressor</span><span class="crayon-h"> </span><span class="crayon-c"># Random Forest</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0025 seconds] -->
<p></p>
<h4>Data</h4>
<p>Let&#8217;s go to the <a href="https://www.kaggle.com/c/allstate-claims-severity" target="_blank" rel="noopener">competition page</a>, sign to the competition and download the data from Data tab. We unzip three files (train.csv, test.csv and sample_submission.csv) to <em>input</em> folder. Then, we import the data to Python:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5dbb3e87e5fa3304127748" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# Load Kaggle data 
df_train = pd.read_csv("input/train.csv")
df_test = pd.read_csv("input/test.csv")

# Display the first five rows to get a feel of the data
df_train.head(5)
df_train.shape
print('First 10 columns: {0} \n Last 20 columns: {1}'.format(list(df_train.columns[:10]), list(df_train.columns[-10:])))
pd.isnull(df_train).values.any()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5dbb3e87e5fa3304127748-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5dbb3e87e5fa3304127748-2">2</div><div class="crayon-num" data-line="crayon-5dbb3e87e5fa3304127748-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5dbb3e87e5fa3304127748-4">4</div><div class="crayon-num" data-line="crayon-5dbb3e87e5fa3304127748-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5dbb3e87e5fa3304127748-6">6</div><div class="crayon-num" data-line="crayon-5dbb3e87e5fa3304127748-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5dbb3e87e5fa3304127748-8">8</div><div class="crayon-num" data-line="crayon-5dbb3e87e5fa3304127748-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5dbb3e87e5fa3304127748-1"><span class="crayon-c"># Load Kaggle data </span></div><div class="crayon-line crayon-striped-line" id="crayon-5dbb3e87e5fa3304127748-2"><span class="crayon-v">df_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">"input/train.csv"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5dbb3e87e5fa3304127748-3"><span class="crayon-v">df_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">"input/test.csv"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5dbb3e87e5fa3304127748-4">&nbsp;</div><div class="crayon-line" id="crayon-5dbb3e87e5fa3304127748-5"><span class="crayon-c"># Display the first five rows to get a feel of the data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5dbb3e87e5fa3304127748-6"><span class="crayon-v">df_train</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5dbb3e87e5fa3304127748-7"><span class="crayon-v">df_train</span><span class="crayon-sy">.</span><span class="crayon-e">shape</span></div><div class="crayon-line crayon-striped-line" id="crayon-5dbb3e87e5fa3304127748-8"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'First 10 columns: {0} \n Last 20 columns: {1}'</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-k ">list</span><span class="crayon-sy">(</span><span class="crayon-v">df_train</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">10</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">list</span><span class="crayon-sy">(</span><span class="crayon-v">df_train</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">10</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5dbb3e87e5fa3304127748-9"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">isnull</span><span class="crayon-sy">(</span><span class="crayon-v">df_train</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">.</span><span class="crayon-k ">any</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>We can see that there are 116 categorical columns (as their names suggest) and 14 continuous (numerical) columns. The names and values of the variables have been standardized to anonymize the data.  There are also id and loss columns. This sums up to 132 columns total. You might already guess we will need to drop id column, as it does not provide any information. The loss is a target variable. So, in total we have 132-2=130 features.</p>
<p>Let&#8217;s get the column names of features, categorical features and continuous features separately. We can also see that categorical variables have text format. Most of machine learning models work only with numeric variables, therefore it is convenient to encode them.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5dbb3e87e5fa9325010101" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
# Split feature names
features = [x for x in df_train.columns if x not in ['id','loss']]
cat_features = [x for x in df_train.select_dtypes(include=['object']).columns if x not in ['id','loss']]
num_features = [x for x in df_train.select_dtypes(exclude=['object']).columns if x not in ['id','loss']]

# Encode cat features
df = pd.concat((df_train[features], df_test[features])).reset_index(drop=True)
for c in range(len(cat_features)):
    df[cat_features[c]] = df[cat_features[c]].astype('category').cat.codes</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5dbb3e87e5fa9325010101-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5dbb3e87e5fa9325010101-2">2</div><div class="crayon-num" data-line="crayon-5dbb3e87e5fa9325010101-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5dbb3e87e5fa9325010101-4">4</div><div class="crayon-num" data-line="crayon-5dbb3e87e5fa9325010101-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5dbb3e87e5fa9325010101-6">6</div><div class="crayon-num" data-line="crayon-5dbb3e87e5fa9325010101-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5dbb3e87e5fa9325010101-8">8</div><div class="crayon-num" data-line="crayon-5dbb3e87e5fa9325010101-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5dbb3e87e5fa9325010101-1"><span class="crayon-c"># Split feature names</span></div><div class="crayon-line crayon-striped-line" id="crayon-5dbb3e87e5fa9325010101-2"><span class="crayon-v">features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">df_train</span><span class="crayon-sy">.</span><span class="crayon-e">columns </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'id'</span><span class="crayon-sy">,</span><span class="crayon-s">'loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5dbb3e87e5fa9325010101-3"><span class="crayon-v">cat_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">df_train</span><span class="crayon-sy">.</span><span class="crayon-e">select_dtypes</span><span class="crayon-sy">(</span><span class="crayon-v">include</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'object'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">columns </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'id'</span><span class="crayon-sy">,</span><span class="crayon-s">'loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5dbb3e87e5fa9325010101-4"><span class="crayon-v">num_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">df_train</span><span class="crayon-sy">.</span><span class="crayon-e">select_dtypes</span><span class="crayon-sy">(</span><span class="crayon-v">exclude</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'object'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">columns </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'id'</span><span class="crayon-sy">,</span><span class="crayon-s">'loss'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5dbb3e87e5fa9325010101-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5dbb3e87e5fa9325010101-6"><span class="crayon-c"># Encode cat features</span></div><div class="crayon-line" id="crayon-5dbb3e87e5fa9325010101-7"><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">df_train</span><span class="crayon-sy">[</span><span class="crayon-v">features</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">df_test</span><span class="crayon-sy">[</span><span class="crayon-v">features</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">reset_index</span><span class="crayon-sy">(</span><span class="crayon-v">drop</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5dbb3e87e5fa9325010101-8"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">cat_features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5dbb3e87e5fa9325010101-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-v">cat_features</span><span class="crayon-sy">[</span><span class="crayon-v">c</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-v">cat_features</span><span class="crayon-sy">[</span><span class="crayon-v">c</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'category'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">cat</span><span class="crayon-sy">.</span><span class="crayon-v">codes</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>Now, we will prepare the data for training.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5dbb3e87e5fb1398575621" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
n_train = df_train.shape[0]    
X_train, y_train = df.iloc[:n_train,:], df_train['loss']
X_test = df.iloc[n_train:,:]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5dbb3e87e5fb1398575621-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5dbb3e87e5fb1398575621-2">2</div><div class="crayon-num" data-line="crayon-5dbb3e87e5fb1398575621-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5dbb3e87e5fb1398575621-1"><span class="crayon-v">n_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5dbb3e87e5fb1398575621-2"><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-v">iloc</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-v">n_train</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">df_train</span><span class="crayon-sy">[</span><span class="crayon-s">'loss'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5dbb3e87e5fb1398575621-3"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-v">iloc</span><span class="crayon-sy">[</span><span class="crayon-v">n_train</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<h4>Models</h4>
<p><img class="aligncenter size-full wp-image-1103" src="http://dkopczyk.quantee.co.uk/wp-content/uploads/2019/04/models.png" alt="" width="743" height="257" srcset="http://dkopczyk.quantee.co.uk/wp-content/uploads/2019/04/models.png 743w, http://dkopczyk.quantee.co.uk/wp-content/uploads/2019/04/models-300x104.png 300w, http://dkopczyk.quantee.co.uk/wp-content/uploads/2019/04/models-600x208.png 600w" sizes="(max-width: 743px) 100vw, 743px" /></p>
<p>Let&#8217;s fit machine learning models. Just for the purpose of this post, we will use two basic estimators for regression problem:</p>
<ul>
<li>a) <a href="https://en.wikipedia.org/wiki/Linear_regression">Linear Regression</a> &#8211; simple linear estimator,</li>
<li>b) <a href="https://en.wikipedia.org/wiki/Random_forest">Random Forest</a> &#8211; non-linear estimator (<em>averaged </em><a href="https://en.wikipedia.org/wiki/Decision_tree_learning">decision trees</a>).</li>
</ul>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5dbb3e87e5fb6117537203" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
lr = LinearRegression() 
lr.fit(X_train, y_train)
# Submission
submission = pd.read_csv("input/sample_submission.csv")
submission.iloc[:, 1] = lr.predict(X_test)
submission.to_csv('lr_starter.csv', index=None)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5dbb3e87e5fb6117537203-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5dbb3e87e5fb6117537203-2">2</div><div class="crayon-num" data-line="crayon-5dbb3e87e5fb6117537203-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5dbb3e87e5fb6117537203-4">4</div><div class="crayon-num" data-line="crayon-5dbb3e87e5fb6117537203-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5dbb3e87e5fb6117537203-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5dbb3e87e5fb6117537203-1"><span class="crayon-v">lr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LinearRegression</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5dbb3e87e5fb6117537203-2"><span class="crayon-v">lr</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5dbb3e87e5fb6117537203-3"><span class="crayon-c"># Submission</span></div><div class="crayon-line crayon-striped-line" id="crayon-5dbb3e87e5fb6117537203-4"><span class="crayon-v">submission</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">"input/sample_submission.csv"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5dbb3e87e5fb6117537203-5"><span class="crayon-v">submission</span><span class="crayon-sy">.</span><span class="crayon-v">iloc</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lr</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5dbb3e87e5fb6117537203-6"><span class="crayon-v">submission</span><span class="crayon-sy">.</span><span class="crayon-e">to_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'lr_starter.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-o">=</span><span class="crayon-t">None</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>You can submit the predictions lr.starter.csv to Kaggle and get MSE=1326.67 on the private score.</p>
<p>We can improve the result by applying more sophisticated machine learning algorithm that will catch non-linear effects in the data. Let&#8217;s apply random forests:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5dbb3e87e5fba845631705" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" touchscreen minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings="" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings=""  style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
rf = RandomForestRegressor(n_estimators=100, n_jobs=-1, random_state=2019)
rf.fit(X_train, y_train)
# Submission
submission = pd.read_csv("input/sample_submission.csv")
submission.iloc[:, 1] = rf.predict(X_test)
submission.to_csv('rf_starter.csv', index=None)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5dbb3e87e5fba845631705-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5dbb3e87e5fba845631705-2">2</div><div class="crayon-num" data-line="crayon-5dbb3e87e5fba845631705-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5dbb3e87e5fba845631705-4">4</div><div class="crayon-num" data-line="crayon-5dbb3e87e5fba845631705-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5dbb3e87e5fba845631705-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5dbb3e87e5fba845631705-1"><span class="crayon-v">rf</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RandomForestRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">n_estimators</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-o">=</span><span class="crayon-cn">2019</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5dbb3e87e5fba845631705-2"><span class="crayon-v">rf</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5dbb3e87e5fba845631705-3"><span class="crayon-c"># Submission</span></div><div class="crayon-line crayon-striped-line" id="crayon-5dbb3e87e5fba845631705-4"><span class="crayon-v">submission</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">"input/sample_submission.csv"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5dbb3e87e5fba845631705-5"><span class="crayon-v">submission</span><span class="crayon-sy">.</span><span class="crayon-v">iloc</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">rf</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5dbb3e87e5fba845631705-6"><span class="crayon-v">submission</span><span class="crayon-sy">.</span><span class="crayon-e">to_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'rf_starter.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-o">=</span><span class="crayon-t">None</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>After sending the results to Kaggle, you will get improved MSE=1247.88.</p>
<p>Although we do not have MSE of a traditional method to compare with, we can see that once we sort out how to get data in a proper form, it just minutes to create first machine learning estimators. Of course, we can spend more time on <a href="http://dkopczyk.quantee.co.uk/hyperparameter-optimization/">hyperparameters optimization</a>, proper visualizations or building and deploying the model, but still, the process is greatly automated. Moreover, due to the fact that traditional methodologies use limited data and do not discover non-linear patterns in the data, we might guess that the two above machine learning models outperform them.</p>
<p>Can we do more in that topic? Certainly yes!</p>
<ul>
<li>Although machine learning models seems to be a black box, there are many ways to improve interpretability and build visualizations (feature importance plots, feature attribution to prediction, residual plots, etc)!</li>
<li>Examples of exploratory data analysis and other solutions of Allstate claims severity problem are placed in kernels on the <a href="https://www.kaggle.com/c/allstate-claims-severity" target="_blank" rel="noopener">competition</a> site.</li>
<li>If any actuary reading this post wants to use machine learning methods, but stick with the traditional methods of claim prediction there are also some possibilities. You can use unsupervised clustering methods, such as <a href="https://en.wikipedia.org/wiki/K-means_clustering" target="_blank" rel="noopener">k-means</a> to group similar policies better!</li>
</ul>
<h3>Summary</h3>
<p>The post gave a basic understanding of claim prediction problem that insurance companies must face. The post was not so much technical, but I hope that it will inspire the management level and actuaries working in insurance sector to learn and discover machine learning techniques in their areas.</p>
						
						<div class="clear"></div>
									        
					</div><!-- .post-content -->
					            					
					<div class="post-meta-container">
						
						<div class="post-author">
						
							<div class="post-author-content">
							
								<h4>Dawid Kopczyk</h4>
								
																
								<div class="author-links">
									
									<a class="author-link-posts" title="Author archive" href="http://dkopczyk.quantee.co.uk/author/admin/">Author archive</a>
									
																		
								</div><!-- .author-links -->
							
							</div><!-- .post-author-content -->
						
						</div><!-- .post-author -->
						
						<div class="post-meta">
						
							<p class="post-date">April 8, 2019</p>
							
														
							<p class="post-categories"><a href="http://dkopczyk.quantee.co.uk/category/machine_learning/" rel="category tag">Machine Learning</a></p>
							
														
							<div class="clear"></div>
							
							<div class="post-nav">
							
																
									<a class="post-nav-prev" title="Previous post: Machine Learning in Insurance: Proxy models" href="http://dkopczyk.quantee.co.uk/proxy/">Previous post</a>
							
																	
									<a class="post-nav-next" title="Next post: From Decision Trees to Gradient Boosting" href="http://dkopczyk.quantee.co.uk/tree-based/">Next post</a>
							
																
																	
								<div class="clear"></div>
							
							</div>
						
						</div><!-- .post-meta -->
						
						<div class="clear"></div>
							
					</div><!-- .post-meta-container -->
																		
					
		
		
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/claim-prediction/#respond" style="display:none;">Cancel reply</a></small></h3>			<form action="http://dkopczyk.quantee.co.uk/wp-comments-post.php" method="post" id="commentform" class="comment-form">
				<p class="comment-notes">Your email address will not be published.</p><p class="comment-form-comment"><textarea id="comment" name="comment" cols="45" rows="6" required></textarea></p><p class="comment-form-author"><input id="author" name="author" type="text" placeholder="Name" value="" size="30" /><label for="author">Author</label> <span class="required">*</span></p>
<p class="comment-form-email"><input id="email" name="email" type="text" placeholder="Email" value="" size="30" /><label for="email">Email</label> <span class="required">*</span></p>
<p class="comment-form-url"><input id="url" name="url" type="text" placeholder="Website" value="" size="30" /><label for="url">Website</label></p>
<p class="comment-subscription-form"><input type="checkbox" name="subscribe_comments" id="subscribe_comments" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-label" for="subscribe_comments">Notify me of follow-up comments by email.</label></p><p class="comment-subscription-form"><input type="checkbox" name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog">Notify me of new posts by email.</label></p><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment" /> <input type='hidden' name='comment_post_ID' value='1093' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="d6f4692a4d" /></p><p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="248"/></p>			</form>
			</div><!-- #respond -->
													                        
						
			</div><!-- .post -->
		
		</div><!-- .content -->
		
		<div class="clear"></div>
		
	</div><!-- .section-inner -->

</div><!-- .wrapper -->
		
<div class="footer section medium-padding bg-graphite">
	
	<div class="section-inner row">
	
				
			<div class="column column-1 one-third">
			
				<div class="widgets">
		
					<div class="widget widget_search"><div class="widget-content"><h3 class="widget-title">Search Form</h3><form method="get" class="searchform" action="http://dkopczyk.quantee.co.uk/">
	<input type="search" value="" placeholder="Search form" name="s" class="s" /> 
	<input type="submit" class="searchsubmit" value="Search">
</form></div><div class="clear"></div></div><div class="widget widget_text"><div class="widget-content"><h3 class="widget-title">Blog Links</h3>			<div class="textwidget"><p><a href="http://dkopczyk.quantee.co.uk/privacy-policy">Privacy Policy</a></p>
</div>
		</div><div class="clear"></div></div>										
				</div>
				
			</div><!-- .column-1 -->
			
					
				
			<div class="column column-2 one-third">
			
				<div class="widgets">
		
							<div class="widget widget_recent_entries"><div class="widget-content">		<h3 class="widget-title">Recent Posts</h3>		<ul>
											<li>
					<a href="http://dkopczyk.quantee.co.uk/covariate_shift/">Covariate Shift in Machine Learning</a>
									</li>
											<li>
					<a href="http://dkopczyk.quantee.co.uk/variational-quantum-circuits/">Variational Quantum Circuits</a>
									</li>
											<li>
					<a href="http://dkopczyk.quantee.co.uk/tree-based/">From Decision Trees to Gradient Boosting</a>
									</li>
					</ul>
		</div><div class="clear"></div></div><div class="widget widget_eu_cookie_law_widget"><div class="widget-content"><div
	class="hide-on-button negative"
	data-hide-timeout="30"
	data-consent-expiration="180"
	id="eu-cookie-law"
>
	<form method="post">
		<input type="submit" value="Close and accept" class="accept" />
	</form>

	Privacy &amp; Cookies: This site uses cookies. By continuing to use this website, you agree to their use. <br />
To find out more, including how to control cookies, see here:
	<a href="http://dkopczyk.quantee.co.uk/privacy-policy/" >
		Cookie Policy	</a>
</div>
</div><div class="clear"></div></div>										
				</div><!-- .widgets -->
				
			</div><!-- .column-2 -->
			
									
				
			<div class="column column-3 one-third">
		
				<div class="widgets">
		
					<div class="widget widget_text"><div class="widget-content"><h3 class="widget-title">Social</h3>			<div class="textwidget"><p><a style="color: #fff;" href="http://dkopczyk.quantee.co.uk/feed/" target="_blank" rel="noopener"><i class="fa fa-rss-square fa-2x " ></i></a> <a style="color: #fff;" href="https://www.facebook.com/quanteeblog/" target="_blank" rel="noopener"><i class="fa fa-facebook-square fa-2x " ></i></a> <a style="color: #fff;" href="https://github.com/dawidkopczyk/" target="_blank" rel="noopener"><i class="fa fa-github-square fa-2x " ></i></a> <a style="color: #fff;" href="https://www.linkedin.com/in/dawid-kopczyk-quantee/" target="_blank" rel="noopener"><i class="fa fa-linkedin-square fa-2x " ></i></a> <a style="color: #fff;" href="https://twitter.com/kopczyk_dawid" target="_blank" rel="noopener"><i class="fa fa-twitter-square fa-2x " ></i></a></p>
</div>
		</div><div class="clear"></div></div>										
				</div><!-- .widgets -->
				
			</div>
			
		<!-- .footer-c -->
		
		<div class="clear"></div>
	
	</div><!-- .footer-inner -->

</div><!-- .footer -->

<div class="credits section bg-dark small-padding">

	<div class="credits-inner section-inner">

		<p class="credits-left fleft">
		
			&copy; 2019 <a href="http://dkopczyk.quantee.co.uk" title="Dawid Kopczyk">Dawid Kopczyk</a><span> &mdash; Powered by <a href="http://www.wordpress.org">WordPress</a></span>
		
		</p>
		
		<p class="credits-right fright">
			
			<span>Theme by <a href="http://www.andersnoren.se">Anders Noren</a> &mdash; </span><a class="tothetop" title="To the top" href="#">Up &uarr;</a>
			
		</p>
		
		<div class="clear"></div>
	
	</div><!-- .credits-inner -->
	
</div><!-- .credits -->

	<div style="display:none">
	</div>
<script type='text/javascript' src='https://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201944'></script>
<script type='text/javascript' src='http://dkopczyk.quantee.co.uk/wp-content/plugins/wp-gif-player/js/play_gif.js?ver=1519304492'></script>
<script type='text/javascript' src='http://dkopczyk.quantee.co.uk/wp-content/plugins/jetpack/_inc/build/spin.min.js?ver=1.3'></script>
<script type='text/javascript' src='http://dkopczyk.quantee.co.uk/wp-content/plugins/wp-gif-player/inc/jquery.spin.js?ver=1.0'></script>
<script type='text/javascript' src='https://secure.gravatar.com/js/gprofiles.js?ver=2019Octaa'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='http://dkopczyk.quantee.co.uk/wp-content/plugins/jetpack/modules/wpgroho.js?ver=4.9.12'></script>
<script type='text/javascript' src='http://dkopczyk.quantee.co.uk/wp-includes/js/imagesloaded.min.js?ver=3.2.0'></script>
<script type='text/javascript' src='http://dkopczyk.quantee.co.uk/wp-includes/js/masonry.min.js?ver=3.3.2'></script>
<script type='text/javascript' src='http://dkopczyk.quantee.co.uk/wp-content/themes/baskerville/js/global.js?ver=4.9.12'></script>
<script type='text/javascript' src='http://dkopczyk.quantee.co.uk/wp-includes/js/comment-reply.min.js?ver=4.9.12'></script>
<script type='text/javascript' src='http://dkopczyk.quantee.co.uk/wp-content/plugins/jetpack/_inc/build/widgets/eu-cookie-law/eu-cookie-law.min.js?ver=20180522'></script>
<script type='text/javascript' src='http://dkopczyk.quantee.co.uk/wp-includes/js/wp-embed.min.js?ver=4.9.12'></script>
<script async="async" type='text/javascript' src='http://dkopczyk.quantee.co.uk/wp-content/plugins/akismet/_inc/form.js?ver=4.0.8'></script>
<script type='text/javascript' src='https://stats.wp.com/e-201944.js' async='async' defer='defer'></script>
<script type='text/javascript'>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:6.5',blog:'142533231',post:'1093',tz:'0',srv:'dkopczyk.quantee.co.uk'} ]);
	_stq.push([ 'clickTrackerInit', '142533231', '1093' ]);
</script>

</body>
</html><!-- WP Fastest Cache file was created in 0.83227705955505 seconds, on 31-10-19 20:05:28 -->